
<!doctype html><html><head><meta charset="utf-8"><title>Agentic Options</title>
<style>body{font-family:monospace;padding:12px;background:#000;color:#0f0;}input,textarea{width:100%;background:#000;color:#0f0;border:1px solid #073;padding:6px;border-radius:4px;}button{padding:8px;border:1px solid #073;background:transparent;color:#0f0;margin-top:8px;}</style>
</head><body>
<h3>Agentic Options</h3>
<label>Endpoint URL</label><input id="endpoint">
<label>API Key</label><input id="apikey" type="password">
<label>Model</label><input id="model">
<label>Temperature</label><input id="temp" type="number" step="0.01">
<div><button id="save">Save</button><button id="ollama">Ollama Preset</button></div>
<div id="status"></div>
<script>
document.addEventListener('DOMContentLoaded', ()=>{
  chrome.storage.sync.get(['endpoint_url','api_key','default_model','temperature'], (cfg)=>{
    if(cfg.endpoint_url) document.getElementById('endpoint').value=cfg.endpoint_url;
    if(cfg.api_key) document.getElementById('apikey').value=cfg.api_key;
    if(cfg.default_model) document.getElementById('model').value=cfg.default_model;
    document.getElementById('temp').value = cfg.temperature ?? 0.63;
  });
  document.getElementById('ollama').onclick = ()=>{
    document.getElementById('endpoint').value = 'http://localhost:11434/v1/chat/completions';
    document.getElementById('apikey').value = '';
    document.getElementById('model').value = 'llama3.2';
    document.getElementById('temp').value = 0.63;
  };
  document.getElementById('save').onclick = async ()=>{
    const endpoint = document.getElementById('endpoint').value;
    const apiKey = document.getElementById('apikey').value;
    const model = document.getElementById('model').value;
    const temp = parseFloat(document.getElementById('temp').value) || 0.63;
    // normalize via background
    chrome.runtime.sendMessage({ type:'normalize_endpoint', url: endpoint }, (res)=>{
      const normalized = res.normalized || endpoint;
      chrome.storage.sync.set({ endpoint_url: normalized, api_key: apiKey, default_model: model, temperature: temp }, ()=>{
        document.getElementById('status').textContent = 'Saved: ' + normalized;
      });
    });
  };
});
</script>
</body></html>
